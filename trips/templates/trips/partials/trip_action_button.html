{% comment %}
    File: templates/trips/partials/trip_action_button.html
    Variables: user, is_organizer, membership, trip
{% endcomment %}
<div class="card shadow-sm">
    <div class="card-body text-center" id="main-action-area">
        {% if not user.is_authenticated %}
            <a href="{% url 'accounts:dang-nhap' %}?next={{ request.path }}" class="btn btn-primary btn-lg w-100">Đăng nhập để tham gia</a>
        
        {% elif is_organizer %}
            <a href="{% url 'trips:update_trip' pk=trip.pk slug=trip.slug %}" class="btn btn-warning btn-lg w-100"><i class="fas fa-edit me-2"></i> Chỉnh sửa Chuyến đi</a>
        
        {% elif not membership %}
            <button id="join-trip-btn" class="btn btn-primary btn-lg w-100">Gửi yêu cầu tham gia</button>
        
        {% elif membership.trang_thai_tham_gia == 'DA_GUI_YEU_CAU' %}
            <p class="mb-2"><strong>Yêu cầu đã được gửi.</strong></p>
            <button id="cancel-request-btn" class="btn btn-outline-secondary w-100">Hủy yêu cầu</button>
        
        {% elif membership.trang_thai_tham_gia == 'DA_THAM_GIA' %}
            <p class="text-success fw-bold"><i class="fas fa-check-circle me-2"></i>Bạn đã là thành viên</p>
            <button id="leave-trip-btn" class="btn btn-outline-danger w-100 mt-2">Rời khỏi chuyến đi</button>
        
        {% elif membership.trang_thai_tham_gia == 'BI_TU_CHOI' %}
            <p class="text-danger fw-bold"><i class="fas fa-times-circle me-2"></i>Yêu cầu của bạn đã bị từ chối.</p>
        
        {% endif %}
    </div>
</div>