{% extends 'base.html' %}
{% load static %}

{% block title %}Xác nhận xóa bài viết{% endblock %}

{% block extra_css %}
<style>
  /* Modern delete confirmation page styling */
  .delete-post-container {
    max-width: 800px;
    margin: 3rem auto;
    padding: 0 1rem;
  }
  
  .delete-post-card {
    background: var(--surface-primary, #fff);
    border-radius: var(--radius-lg, 12px);
    box-shadow: var(--shadow-lg, 0 10px 25px rgba(0,0,0,0.1));
    overflow: hidden;
    border: 2px solid #dc3545;
  }
  
  .delete-post-header {
    background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
    padding: 1.5rem 2rem;
    color: white;
  }
  
  .delete-post-header h1 {
    margin: 0;
    font-size: 1.5rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }
  
  .delete-post-body {
    padding: 2rem;
  }
  
  .warning-message {
    font-size: 1.1rem;
    color: var(--text-primary, #1a1a1a);
    margin-bottom: 1.5rem;
    line-height: 1.6;
  }
  
  .post-preview {
    background: var(--surface-secondary, #f8f9fa);
    border: 2px solid var(--border-light, #e0e0e0);
    border-radius: var(--radius-md, 8px);
    padding: 1.5rem;
    margin: 1.5rem 0;
  }
  
  .post-preview-title {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-primary, #1a1a1a);
    margin-bottom: 0.75rem;
  }
  
  .post-preview-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    font-size: 0.875rem;
    color: var(--text-secondary, #666);
    margin-bottom: 1rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--border-light, #e0e0e0);
  }
  
  .post-preview-meta strong {
    color: var(--text-primary, #1a1a1a);
  }
  
  .post-preview-content {
    color: var(--text-secondary, #666);
    line-height: 1.6;
    margin-bottom: 1rem;
  }
  
  .media-preview-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 0.75rem;
    margin-top: 1rem;
  }
  
  .media-preview-item {
    position: relative;
    aspect-ratio: 1;
    border-radius: var(--radius-sm, 6px);
    overflow: hidden;
    background: var(--surface-primary, #fff);
  }
  
  .media-preview-item img,
  .media-preview-item video {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  .post-stats {
    display: flex;
    gap: 2rem;
    padding-top: 1rem;
    margin-top: 1rem;
    border-top: 1px solid var(--border-light, #e0e0e0);
    font-size: 0.875rem;
    color: var(--text-secondary, #666);
  }
  
  .post-stats strong {
    color: var(--text-primary, #1a1a1a);
    margin-right: 0.25rem;
  }
  
  .danger-alert {
    background: linear-gradient(135deg, rgba(220, 53, 69, 0.1) 0%, rgba(200, 35, 51, 0.05) 100%);
    border-left: 4px solid #dc3545;
    padding: 1rem 1.25rem;
    border-radius: var(--radius-md, 8px);
    margin: 1.5rem 0;
  }
  
  .danger-alert strong {
    color: #dc3545;
    display: block;
    margin-bottom: 0.25rem;
  }
  
  .form-actions {
    display: flex;
    gap: 1rem;
    margin-top: 2rem;
  }
  
  .btn {
    padding: 0.75rem 1.5rem;
    border-radius: var(--radius-md, 8px);
    font-weight: 600;
    font-size: 1rem;
    border: none;
    cursor: pointer;
    transition: all 0.2s ease;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    text-decoration: none;
  }
  
  .btn-danger {
    background: #dc3545;
    color: white;
  }
  
  .btn-danger:hover {
    background: #c82333;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(220, 53, 69, 0.4);
  }
  
  .btn-secondary {
    background: var(--surface-secondary, #f0f0f0);
    color: var(--text-primary, #1a1a1a);
  }
  
  .btn-secondary:hover {
    background: var(--border-light, #e0e0e0);
  }
  
  @media (max-width: 768px) {
    .delete-post-container {
      margin: 1.5rem auto;
    }
    
    .delete-post-body {
      padding: 1.5rem;
    }
    
    .media-preview-grid {
      grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
    }
    
    .form-actions {
      flex-direction: column;
    }
    
    .btn {
      width: 100%;
      justify-content: center;
    }
  }
</style>
{% endblock %}

{% block content %}
<div class="delete-post-container">
  <div class="delete-post-card">
    <div class="delete-post-header">
      <h1>
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="3 6 5 6 21 6"></polyline>
          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
          <line x1="10" y1="11" x2="10" y2="17"></line>
          <line x1="14" y1="11" x2="14" y2="17"></line>
        </svg>
        Xác nhận xóa bài viết
      </h1>
    </div>

    <div class="delete-post-body">
      <p class="warning-message">
        Bạn có chắc chắn muốn xóa vĩnh viễn bài viết này không? Tất cả dữ liệu liên quan bao gồm ảnh, video, bình luận và lượt tương tác sẽ bị xóa.
      </p>
      
      <div class="post-preview">
        <h2 class="post-preview-title">{{ bai_viet.tieu_de }}</h2>
        
        <div class="post-preview-meta">
          <span>
            <strong>Tác giả:</strong> {{ bai_viet.tac_gia.username }}
          </span>
          <span>
            <strong>Ngày đăng:</strong> {{ bai_viet.ngay_dang|date:"d/m/Y H:i" }}
          </span>
          {% if bai_viet.trang_thai == 'da_duyet' %}
          <span>
            <strong>Trạng thái:</strong> 
            <span style="color: #28a745;">Đã duyệt</span>
          </span>
          {% elif bai_viet.trang_thai == 'cho_duyet' %}
          <span>
            <strong>Trạng thái:</strong> 
            <span style="color: #ffc107;">Chờ duyệt</span>
          </span>
          {% else %}
          <span>
            <strong>Trạng thái:</strong> 
            <span style="color: #dc3545;">Từ chối</span>
          </span>
          {% endif %}
        </div>

        <div class="post-preview-content">
          {{ bai_viet.noi_dung|truncatewords_html:50 }}
        </div>

        {% if bai_viet.media.all %}
        <div class="media-preview-grid">
          {% for media in bai_viet.media.all|slice:":6" %}
          <div class="media-preview-item">
            {% if media.loai_media == 'anh' %}
              <img src="{{ media.duong_dan_file.url }}" alt="Media preview">
            {% else %}
              <video>
                <source src="{{ media.duong_dan_file.url }}">
              </video>
            {% endif %}
          </div>
          {% endfor %}
        </div>
        {% endif %}

        {% if bai_viet.trang_thai == 'da_duyet' %}
        <div class="post-stats">
          <span>
            <strong>{{ bai_viet.luot_binh_chon }}</strong> lượt upvote
          </span>
          <span>
            <strong>{{ bai_viet.binh_luan.count }}</strong> bình luận
          </span>
        </div>
        {% endif %}
      </div>
      
      <div class="danger-alert">
        <strong>Cảnh báo: Hành động này không thể hoàn tác!</strong>
        <p style="margin: 0;">Tất cả dữ liệu sẽ bị xóa vĩnh viễn khỏi hệ thống.</p>
      </div>

      <form method="post">
        {% csrf_token %}
        <div class="form-actions">
          <button type="submit" class="btn btn-danger">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="3 6 5 6 21 6"></polyline>
              <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
            </svg>
            Xác nhận xóa bài viết
          </button>
          <a href="{% url 'community:bai-viet-cua-toi' %}" class="btn btn-secondary">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
            Hủy bỏ
          </a>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
