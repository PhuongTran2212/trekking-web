{% extends "admin_base.html" %}

{% block title %}{{ article.tieu_de }}{% endblock %}

{% block content %}
<!-- CUSTOM CSS FOR ARTICLE DETAIL -->
<style>
    :root {
        --primary-color: #059669;
        --primary-hover: #047857;
        --text-primary: #111827;
        --text-secondary: #4b5563;
        --text-muted: #9ca3af;
        --bg-light: #f9fafb;
        --border-color: #e5e7eb;
        --link-color: #2563eb;
    }

    /* Layout Wrapper */
    .article-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 2rem;
        background: white;
        min-height: 80vh;
    }

    /* Navigation */
    .nav-back {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        text-decoration: none;
        color: var(--text-secondary);
        font-weight: 500;
        font-size: 0.9rem;
        margin-bottom: 2rem;
        transition: color 0.2s;
    }
    .nav-back:hover {
        color: var(--primary-color);
    }

    /* Header Section */
    .article-header {
        margin-bottom: 2.5rem;
        padding-bottom: 2rem;
        border-bottom: 1px solid var(--border-color);
    }

    .category-badge {
        display: inline-block;
        background-color: #ecfdf5;
        color: var(--primary-color);
        padding: 0.25rem 0.75rem;
        border-radius: 99px;
        font-size: 0.8rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.025em;
        margin-bottom: 1rem;
    }

    .article-title {
        font-size: 2.25rem;
        line-height: 1.3;
        font-weight: 800;
        color: var(--text-primary);
        margin: 0 0 1.5rem 0;
        letter-spacing: -0.025em;
    }

    .article-meta {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 1rem;
        color: var(--text-secondary);
        font-size: 0.95rem;
    }

    .meta-item {
        display: flex;
        align-items: center;
        gap: 0.35rem;
    }

    .author-avatar {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        background-color: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.7rem;
        font-weight: bold;
        color: var(--text-secondary);
    }

    .status-badge {
        background-color: #fffbeb;
        color: #b45309;
        padding: 0.15rem 0.6rem;
        border-radius: 4px;
        font-size: 0.75rem;
        font-weight: 600;
        border: 1px solid #fcd34d;
    }

    /* Featured Image */
    .featured-image-wrapper {
        margin: 0 0 3rem 0;
        border-radius: 1rem;
        overflow: hidden;
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }
    .featured-image {
        width: 100%;
        height: auto;
        display: block;
        object-fit: cover;
    }

    /* Article Content (Rich Text Styling) */
    .article-content {
        color: #374151;
        font-size: 1.125rem; /* 18px for better reading */
        line-height: 1.8;
        font-family: 'Georgia', 'Cambria', serif; /* Serif font for body text tends to be better for long reads */
    }

    /* Fallback to sans-serif if you prefer modern look */
    .article-content {
        font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }

    .article-content p {
        margin-bottom: 1.5rem;
    }

    .article-content h2 {
        font-size: 1.75rem;
        font-weight: 700;
        color: var(--text-primary);
        margin: 2.5rem 0 1rem 0;
        line-height: 1.3;
    }

    .article-content h3 {
        font-size: 1.4rem;
        font-weight: 600;
        color: var(--text-primary);
        margin: 2rem 0 1rem 0;
    }

    .article-content ul, .article-content ol {
        margin-bottom: 1.5rem;
        padding-left: 1.5rem;
    }

    .article-content li {
        margin-bottom: 0.5rem;
    }

    .article-content blockquote {
        border-left: 4px solid var(--primary-color);
        background-color: #f9fafb;
        margin: 2rem 0;
        padding: 1rem 1.5rem;
        font-style: italic;
        color: var(--text-secondary);
        border-radius: 0 0.5rem 0.5rem 0;
    }

    .article-content img {
        max-width: 100%;
        height: auto;
        border-radius: 0.5rem;
        margin: 2rem 0;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }

    .article-content a {
        color: var(--link-color);
        text-decoration: underline;
        text-underline-offset: 2px;
    }

    .article-content a:hover {
        color: var(--primary-color);
    }

    /* Admin Actions Footer */
    .admin-actions {
        margin-top: 4rem;
        padding-top: 2rem;
        border-top: 1px solid var(--border-color);
        background-color: #f8fafc;
        padding: 2rem;
        border-radius: 0.75rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .admin-text {
        font-size: 0.9rem;
        color: var(--text-secondary);
    }

    .btn-edit {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        background-color: var(--primary-color);
        color: white;
        padding: 0.625rem 1.25rem;
        border-radius: 0.5rem;
        font-weight: 500;
        text-decoration: none;
        transition: all 0.2s;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .btn-edit:hover {
        background-color: var(--primary-hover);
        transform: translateY(-1px);
        box-shadow: 0 4px 6px rgba(0,0,0,0.15);
    }

    @media (max-width: 640px) {
        .article-container { padding: 1rem; }
        .article-title { font-size: 1.75rem; }
        .admin-actions { flex-direction: column; gap: 1rem; align-items: flex-start; }
        .btn-edit { width: 100%; justify-content: center; }
    }
</style>

<div class="article-container">
    <!-- Breadcrumb -->
    <nav>
        {% if user.is_staff %}
            <a href="{% url 'articles:admin-list' %}" class="nav-back">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                Quay lại quản lý
            </a>
        {% else %}
             <a href="/" class="nav-back">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                Trang chủ
            </a>
        {% endif %}
    </nav>

    <!-- Header Bài viết -->
    <header class="article-header">
        {% if article.chuyen_muc %}
            <span class="category-badge">
                {{ article.chuyen_muc.ten }}
            </span>
        {% endif %}
        
        <h1 class="article-title">{{ article.tieu_de }}</h1>

        <div class="article-meta">
            <div class="meta-item">
                <div class="author-avatar">
                    {{ article.tac_gia.username|slice:":1"|upper }}
                </div>
                <strong>{{ article.tac_gia.username }}</strong>
            </div>
            
            <div class="meta-item" style="color: #d1d5db;">&bull;</div>
            
            <div class="meta-item">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                {{ article.ngay_dang|date:"d/m/Y" }}
            </div>

            {% if not article.da_duyet %}
                <div class="meta-item" style="margin-left: auto;">
                    <span class="status-badge">
                        <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 4px;"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                        Chưa duyệt - Xem trước
                    </span>
                </div>
            {% endif %}
        </div>
    </header>

    <!-- Ảnh đại diện -->
    {% if article.anh_dai_dien %}
        <div class="featured-image-wrapper">
            <img src="{{ article.anh_dai_dien.url }}" alt="{{ article.tieu_de }}" class="featured-image">
        </div>
    {% endif %}

    <!-- Nội dung bài viết -->
    <article class="article-content">
        {{ article.noi_dung|safe|linebreaks }}
    </article>

    <!-- Footer dành cho Admin -->
    {% if user.is_staff %}
    <div class="admin-actions">
        <div class="admin-text">
            <strong>Khu vực quản trị:</strong> Bạn đang xem bài viết với quyền quản lý.
        </div>
        <a href="{% url 'articles:admin-update' article.pk %}" class="btn-edit">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
            Chỉnh sửa bài viết
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}