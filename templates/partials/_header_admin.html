{% load static %}
<header class="header">
    <!-- === PHẦN BÊN TRÁI: THANH TÌM KIẾM === -->
    <div class="header-left">
        <div class="admin-search">
            <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
            </svg>
            <input type="text" class="search-input" placeholder="Tìm kiếm users, chuyến đi, báo cáo...">
        </div>
    </div>

    <!-- === PHẦN BÊN PHẢI: HÀNH ĐỘNG === -->
    <div class="header-right">
        <!-- Nút chuyển sang chế độ người dùng -->
        <a href="{% url 'home' %}" class="btn-secondary" title="Trải nghiệm trang với vai trò người dùng">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 16px; height: 16px;">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" />
            </svg>
            Chế độ User
        </a>

        <!-- Menu thông tin cá nhân của Admin -->
        <div class="profile-menu">
            <button class="profile-btn" id="profile-btn">
                <img src="{% if user.taikhoanhoso.anh_dai_dien %}{{ user.taikhoanhoso.anh_dai_dien }}{% else %}{% static 'images/default_avatar.png' %}{% endif %}" alt="Avatar của {{ user.username }}">
            </button>
            
            <div class="dropdown-menu" id="profile-dropdown">
                <div class="dropdown-header">
                    <div style="font-weight: 600;">{{ user.get_full_name|default:user.username }}</div>
                    <div style="font-size: 0.875rem; color: var(--gray-500);">@{{ user.username }}</div>
                </div>
                <a href="#" class="dropdown-item">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275" /></svg>
                    Cài đặt Admin
                </a>
                <div class="dropdown-divider"></div>
                
                <!-- =================================================== -->
                <!-- === DÒNG CODE ĐÃ ĐƯỢC SỬA LỖI === -->
                <form action="{% url 'accounts:dang-xuat' %}" method="post" style="margin: 0;">
                <!-- =================================================== -->
                    {% csrf_token %}
                    <button type="submit" style="background: none; border: none; padding: 0; width: 100%; cursor: pointer; text-align: left;">
                         <span class="dropdown-item danger">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9" /></svg>
                            Đăng xuất
                        </span>
                    </button>
                </form>
            </div>
        </div>
    </div>
</header>